{"version":3,"file":"favicon.js","sources":["../../src/middlewares/favicon.ts"],"sourcesContent":["import { existsSync } from 'fs';\nimport { resolve } from 'path';\nimport koaFavicon from 'koa-favicon';\nimport type { Core } from '@strapi/types';\n\nexport type Config = NonNullable<Parameters<typeof koaFavicon>[1]>;\n\nconst defaults = {\n  path: 'favicon.png',\n  maxAge: 86400000,\n};\n\nexport const favicon: Core.MiddlewareFactory<Config> = (config, { strapi }) => {\n  const { maxAge, path: faviconPathConfig } = { ...defaults, ...config };\n  const { root: appRoot } = strapi.dirs.app;\n  let faviconPath = faviconPathConfig;\n\n  if (!existsSync(resolve(appRoot, faviconPathConfig))) {\n    if (existsSync(resolve(appRoot, defaults.path))) {\n      faviconPath = defaults.path;\n    } else if (existsSync(resolve(appRoot, 'favicon.ico'))) {\n      faviconPath = 'favicon.ico';\n    }\n  }\n\n  return koaFavicon(resolve(appRoot, faviconPath), { maxAge });\n};\n"],"names":["defaults","path","maxAge","favicon","config","strapi","faviconPathConfig","root","appRoot","dirs","app","faviconPath","existsSync","resolve","koaFavicon"],"mappings":";;;;;;AAOA,MAAMA,QAAW,GAAA;IACfC,IAAM,EAAA,aAAA;IACNC,MAAQ,EAAA;AACV,CAAA;MAEaC,OAA0C,GAAA,CAACC,MAAQ,EAAA,EAAEC,MAAM,EAAE,GAAA;AACxE,IAAA,MAAM,EAAEH,MAAM,EAAED,IAAMK,EAAAA,iBAAiB,EAAE,GAAG;AAAE,QAAA,GAAGN,QAAQ;AAAE,QAAA,GAAGI;AAAO,KAAA;IACrE,MAAM,EAAEG,MAAMC,OAAO,EAAE,GAAGH,MAAOI,CAAAA,IAAI,CAACC,GAAG;AACzC,IAAA,IAAIC,WAAcL,GAAAA,iBAAAA;AAElB,IAAA,IAAI,CAACM,aAAAA,CAAWC,YAAQL,CAAAA,OAAAA,EAASF,iBAAqB,CAAA,CAAA,EAAA;AACpD,QAAA,IAAIM,aAAWC,CAAAA,YAAAA,CAAQL,OAASR,EAAAA,QAAAA,CAASC,IAAI,CAAI,CAAA,EAAA;AAC/CU,YAAAA,WAAAA,GAAcX,SAASC,IAAI;AAC7B,SAAA,MAAO,IAAIW,aAAAA,CAAWC,YAAQL,CAAAA,OAAAA,EAAS,aAAiB,CAAA,CAAA,EAAA;YACtDG,WAAc,GAAA,aAAA;AAChB;AACF;IAEA,OAAOG,UAAAA,CAAWD,YAAQL,CAAAA,OAAAA,EAASG,WAAc,CAAA,EAAA;AAAET,QAAAA;AAAO,KAAA,CAAA;AAC5D;;;;"}