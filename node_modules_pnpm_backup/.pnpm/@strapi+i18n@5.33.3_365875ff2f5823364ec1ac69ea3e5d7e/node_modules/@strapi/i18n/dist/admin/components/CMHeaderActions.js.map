{"version":3,"file":"CMHeaderActions.js","sources":["../../../admin/src/components/CMHeaderActions.tsx"],"sourcesContent":["import * as React from 'react';\n\nimport { skipToken } from '@reduxjs/toolkit/query';\nimport {\n  useNotification,\n  useQueryParams,\n  Table,\n  useAPIErrorHandler,\n  FormErrors,\n  useForm,\n} from '@strapi/admin/strapi-admin';\nimport { useAIAvailability } from '@strapi/admin/strapi-admin/ee';\nimport {\n  type DocumentActionComponent,\n  type DocumentActionProps,\n  unstable_useDocument as useDocument,\n  unstable_useDocumentActions as useDocumentActions,\n  buildValidParams,\n  HeaderActionProps,\n} from '@strapi/content-manager/strapi-admin';\nimport {\n  Flex,\n  Status,\n  Typography,\n  Button,\n  Modal,\n  Field,\n  SingleSelect,\n  SingleSelectOption,\n  Dialog,\n  type StatusVariant,\n  Box,\n  Link,\n} from '@strapi/design-system';\nimport { WarningCircle, ListPlus, Trash, Earth, Cross, Plus, Sparkle, Loader } from '@strapi/icons';\nimport { useIntl } from 'react-intl';\nimport { NavLink, useNavigate } from 'react-router-dom';\nimport { styled } from 'styled-components';\n\nimport { useAILocalizationJobsPolling } from '../hooks/useAILocalizationJobsPolling';\nimport { useI18n } from '../hooks/useI18n';\nimport { useGetAILocalizationJobsByDocumentQuery } from '../services/aiLocalizationJobs';\nimport { useGetLocalesQuery } from '../services/locales';\nimport { useGetManyDraftRelationCountQuery } from '../services/relations';\nimport { useGetSettingsQuery } from '../services/settings';\nimport { cleanData } from '../utils/clean';\nimport { getTranslation } from '../utils/getTranslation';\nimport { capitalize } from '../utils/strings';\n\nimport { BulkLocaleActionModal } from './BulkLocaleActionModal';\n\nimport type { Locale } from '../../../shared/contracts/locales';\nimport type { I18nBaseQuery } from '../types';\nimport type { Modules } from '@strapi/types';\n\n/* -------------------------------------------------------------------------------------------------\n * LocalePickerAction\n * -----------------------------------------------------------------------------------------------*/\n\ninterface LocaleOptionProps {\n  isDraftAndPublishEnabled: boolean;\n  locale: Locale;\n  status: 'draft' | 'published' | 'modified';\n  entryExists: boolean;\n  translationStatus?: 'processing' | 'failed' | 'completed' | undefined;\n}\n\nconst statusVariants: Record<LocaleOptionProps['status'], StatusVariant> = {\n  draft: 'secondary',\n  published: 'success',\n  modified: 'alternative',\n};\n\nconst LocaleOption = ({\n  isDraftAndPublishEnabled,\n  locale,\n  status,\n  entryExists,\n}: LocaleOptionProps) => {\n  const { formatMessage } = useIntl();\n\n  if (!entryExists) {\n    return formatMessage(\n      {\n        id: getTranslation('CMEditViewLocalePicker.locale.create'),\n        defaultMessage: 'Create <bold>{locale}</bold> locale',\n      },\n      {\n        bold: (locale: React.ReactNode) => <b>{locale}</b>,\n        locale: locale.name,\n      }\n    );\n  }\n\n  return (\n    <Flex width=\"100%\" gap={1} justifyContent=\"space-between\">\n      <Typography>{locale.name}</Typography>\n      {isDraftAndPublishEnabled ? (\n        <Status\n          display=\"flex\"\n          paddingLeft=\"6px\"\n          paddingRight=\"6px\"\n          paddingTop=\"2px\"\n          paddingBottom=\"2px\"\n          size=\"S\"\n          variant={statusVariants[status]}\n        >\n          <Typography tag=\"span\" variant=\"pi\" fontWeight=\"bold\">\n            {capitalize(status)}\n          </Typography>\n        </Status>\n      ) : null}\n    </Flex>\n  );\n};\n\nconst LocaleOptionStartIcon = ({\n  entryWithLocaleExists,\n  translationStatus,\n  index,\n}: {\n  entryWithLocaleExists: boolean;\n  translationStatus?: 'processing' | 'failed' | 'completed' | undefined;\n  index?: number;\n}) => {\n  const isAiAvailable = useAIAvailability();\n\n  if (!entryWithLocaleExists) {\n    return <Plus />;\n  }\n\n  if (isAiAvailable && index !== 0 && translationStatus === 'failed') {\n    return <WarningCircle fill=\"warning600\" />;\n  }\n\n  return null;\n};\n\nconst LocalePickerAction = ({\n  document,\n  meta,\n  model,\n  collectionType,\n  documentId,\n}: HeaderActionProps) => {\n  const { formatMessage } = useIntl();\n  const [{ query }, setQuery] = useQueryParams<I18nBaseQuery>();\n  const { hasI18n, canCreate, canRead } = useI18n();\n  const { data: locales = [] } = useGetLocalesQuery();\n  const currentDesiredLocale = query.plugins?.i18n?.locale;\n  const { schema } = useDocument({\n    model,\n    collectionType,\n    documentId,\n    params: { locale: currentDesiredLocale },\n  });\n  const { data: jobData } = useGetAILocalizationJobsByDocumentQuery({\n    documentId: documentId!,\n    model: model!,\n    collectionType: collectionType!,\n  });\n  const { data: settings } = useGetSettingsQuery();\n  const isAiAvailable = useAIAvailability();\n  const setValues = useForm('LocalePickerAction', (state) => state.setValues);\n\n  const handleSelect = React.useCallback(\n    (value: string) => {\n      setQuery(\n        {\n          plugins: {\n            ...query.plugins,\n            i18n: {\n              locale: value,\n            },\n          },\n        },\n        'push',\n        true\n      );\n    },\n    [query.plugins, setQuery]\n  );\n\n  const nonTranslatedFields = React.useMemo(() => {\n    if (!schema?.attributes) return [];\n    return Object.keys(schema.attributes).filter((field) => {\n      const attribute = schema.attributes[field] as Record<string, unknown>;\n      return (attribute?.pluginOptions as any)?.i18n?.localized === false;\n    });\n  }, [schema?.attributes]);\n\n  const sourceLocaleData = React.useMemo(() => {\n    if (!Array.isArray(locales) || !meta?.availableLocales) return null;\n\n    const defaultLocale = locales.find((locale: Locale) => locale.isDefault);\n    const existingLocales = meta.availableLocales.map((loc) => loc.locale);\n\n    const sourceLocaleCode =\n      defaultLocale &&\n      existingLocales.includes(defaultLocale.code) &&\n      defaultLocale.code !== currentDesiredLocale\n        ? defaultLocale.code\n        : existingLocales.find((locale) => locale !== currentDesiredLocale);\n\n    if (!sourceLocaleCode) return null;\n\n    // Find the document data from availableLocales (now includes non-translatable fields)\n    const sourceLocaleDoc = meta.availableLocales.find((loc) => loc.locale === sourceLocaleCode);\n\n    return sourceLocaleDoc\n      ? { locale: sourceLocaleCode, data: sourceLocaleDoc as Record<string, unknown> }\n      : null;\n  }, [locales, meta?.availableLocales, currentDesiredLocale]);\n\n  /**\n   * Prefilling form with non-translatable fields from already existing locale\n   */\n  React.useEffect(() => {\n    // Only run when creating a new locale (no document ID yet) and when we have non-translatable fields\n    if (!document?.id && nonTranslatedFields.length > 0 && sourceLocaleData?.data) {\n      const dataToSet = nonTranslatedFields.reduce(\n        (acc: Record<string, unknown>, field: string) => {\n          acc[field] = sourceLocaleData.data[field];\n          return acc;\n        },\n        {}\n      );\n\n      if (Object.keys(dataToSet).length > 0) {\n        setValues(dataToSet);\n      }\n    }\n  }, [document?.id, nonTranslatedFields, sourceLocaleData?.data, setValues]);\n\n  React.useEffect(() => {\n    if (!Array.isArray(locales) || !hasI18n) {\n      return;\n    }\n    /**\n     * Handle the case where the current locale query param doesn't exist\n     * in the list of available locales, so we redirect to the default locale.\n     */\n    const doesLocaleExist = locales.find((loc) => loc.code === currentDesiredLocale);\n    const defaultLocale = locales.find((locale) => locale.isDefault);\n    if (!doesLocaleExist && defaultLocale?.code) {\n      handleSelect(defaultLocale.code);\n    }\n  }, [handleSelect, hasI18n, locales, currentDesiredLocale]);\n\n  const currentLocale = Array.isArray(locales)\n    ? locales.find((locale) => locale.code === currentDesiredLocale)\n    : undefined;\n\n  // Use meta.availableLocales instead of document.localizations\n  // meta.availableLocales contains all locales for the document, even when creating new locales\n  const availableLocales = meta?.availableLocales ?? [];\n  const documentLocalizations = document?.localizations ?? [];\n\n  // Prefer meta.availableLocales as it's more reliable, fallback to document.localizations\n  const allLocalizations = availableLocales.length > 0 ? availableLocales : documentLocalizations;\n\n  const allCurrentLocales = [\n    { status: getDocumentStatus(document, meta), locale: currentLocale?.code },\n    ...allLocalizations,\n  ];\n\n  if (!hasI18n || !Array.isArray(locales) || locales.length === 0) {\n    return null;\n  }\n\n  const displayedLocales = locales.filter((locale) => {\n    /**\n     * If you can read we allow you to see the locale exists\n     * otherwise the locale is hidden.\n     */\n    return canRead.includes(locale.code);\n  });\n\n  const localesSortingDefaultFirst = displayedLocales.sort((a, b) =>\n    a.isDefault ? -1 : b.isDefault ? 1 : 0\n  );\n\n  return {\n    label: formatMessage({\n      id: getTranslation('Settings.locales.modal.locales.label'),\n      defaultMessage: 'Locales',\n    }),\n    options: localesSortingDefaultFirst.map((locale, index) => {\n      const entryWithLocaleExists = allCurrentLocales.some((doc) => doc.locale === locale.code);\n\n      const currentLocaleDoc = allCurrentLocales.find((doc) =>\n        'locale' in doc ? doc.locale === locale.code : false\n      );\n\n      const permissionsToCheck = currentLocaleDoc ? canRead : canCreate;\n\n      if (isAiAvailable && settings?.data?.aiLocalizations) {\n        return {\n          _render: () => (\n            <React.Fragment key={index}>\n              <SingleSelectOption\n                disabled={!permissionsToCheck.includes(locale.code)}\n                key={locale.code}\n                startIcon={\n                  <LocaleOptionStartIcon\n                    entryWithLocaleExists={entryWithLocaleExists}\n                    translationStatus={jobData?.data?.status}\n                    index={index}\n                  />\n                }\n                value={locale.code}\n              >\n                <LocaleOption\n                  isDraftAndPublishEnabled={!!schema?.options?.draftAndPublish}\n                  locale={locale}\n                  status={currentLocaleDoc?.status}\n                  entryExists={entryWithLocaleExists}\n                />\n              </SingleSelectOption>\n              {localesSortingDefaultFirst.length > 1 && index === 0 && (\n                <Box paddingRight={4} paddingLeft={4} paddingTop={2} paddingBottom={2}>\n                  <Typography variant=\"sigma\">\n                    {formatMessage({\n                      id: getTranslation('CMEditViewLocalePicker.locale.ai-translations'),\n                      defaultMessage: 'AI Translations',\n                    })}\n                  </Typography>\n                </Box>\n              )}\n            </React.Fragment>\n          ),\n        };\n      }\n\n      return {\n        disabled: !permissionsToCheck.includes(locale.code),\n        value: locale.code,\n        label: (\n          <LocaleOption\n            isDraftAndPublishEnabled={!!schema?.options?.draftAndPublish}\n            locale={locale}\n            status={currentLocaleDoc?.status}\n            entryExists={entryWithLocaleExists}\n            translationStatus={jobData?.data?.status}\n          />\n        ),\n        startIcon: <LocaleOptionStartIcon entryWithLocaleExists={entryWithLocaleExists} />,\n      };\n    }),\n    customizeContent: () => currentLocale?.name,\n    onSelect: handleSelect,\n    value: currentLocale,\n  };\n};\n\ntype UseDocument = typeof useDocument;\n\nconst getDocumentStatus = (\n  document: ReturnType<UseDocument>['document'],\n  meta: ReturnType<UseDocument>['meta']\n): 'draft' | 'published' | 'modified' => {\n  const docStatus = document?.status;\n  const statuses = meta?.availableStatus ?? [];\n\n  /**\n   * Creating an entry\n   */\n  if (!docStatus) {\n    return 'draft';\n  }\n\n  /**\n   * We're viewing a draft, but the document could have a published version\n   */\n  if (docStatus === 'draft' && statuses.find((doc) => doc.publishedAt !== null)) {\n    return 'published';\n  }\n\n  return docStatus;\n};\n\n/* -------------------------------------------------------------------------------------------------\n * AISettingsStatusAction\n * -----------------------------------------------------------------------------------------------*/\n\nconst AITranslationStatusIcon = styled(Status)<{ $isAISettingEnabled: boolean }>`\n  display: flex;\n  gap: ${({ theme }) => theme.spaces[1]};\n  justify-content: center;\n  align-items: center;\n  height: 100%;\n\n  // Disabled state\n  ${({ $isAISettingEnabled, theme }) =>\n    !$isAISettingEnabled &&\n    `\n    background-color: ${theme.colors.neutral150};\n  `}\n\n  svg {\n    ${({ $isAISettingEnabled, theme }) =>\n      !$isAISettingEnabled &&\n      `\n        fill: ${theme.colors.neutral300};\n      `}\n  }\n`;\n\nconst SpinningLoader = styled(Loader)`\n  @keyframes spin {\n    from {\n      transform: rotate(0deg);\n    }\n    to {\n      transform: rotate(360deg);\n    }\n  }\n\n  animation: spin 2s linear infinite;\n`;\n\nconst AITranslationStatusAction = ({ documentId, model, collectionType }: HeaderActionProps) => {\n  const { formatMessage } = useIntl();\n  const isAIAvailable = useAIAvailability();\n  const { data: settings } = useGetSettingsQuery();\n  const isAISettingEnabled = settings?.data?.aiLocalizations;\n  const { hasI18n } = useI18n();\n\n  // Poll for AI localizations jobs when AI is enabled and we have a documentId\n  const { status } = useAILocalizationJobsPolling({\n    documentId,\n    model,\n    collectionType,\n  });\n  const statusVariant = (() => {\n    if (status === 'failed') {\n      return 'warning';\n    }\n\n    if (isAISettingEnabled) {\n      return 'alternative';\n    }\n\n    return 'neutral';\n  })();\n\n  // Do not display this action when i18n is not available\n  if (!hasI18n) {\n    return null;\n  }\n\n  // Do not display this action when AI is not available\n  if (!isAIAvailable) {\n    return null;\n  }\n\n  return {\n    _status: {\n      message: (\n        <Box\n          height=\"100%\"\n          aria-label={formatMessage({\n            id: getTranslation('CMEditViewAITranslation.status-aria-label'),\n            defaultMessage: 'AI Translation Status',\n          })}\n        >\n          <AITranslationStatusIcon\n            $isAISettingEnabled={Boolean(isAISettingEnabled)}\n            variant={statusVariant}\n            size=\"S\"\n          >\n            {status === 'processing' ? <SpinningLoader /> : <Sparkle />}\n          </AITranslationStatusIcon>\n        </Box>\n      ),\n      tooltip: (\n        <Flex direction=\"column\" padding={4} alignItems=\"flex-start\" width=\"25rem\">\n          <Typography variant=\"pi\" fontWeight=\"600\">\n            {formatMessage(\n              {\n                id: getTranslation('CMEditViewAITranslation.status-title'),\n                defaultMessage:\n                  '{enabled, select, true {AI translation enabled} false {AI translation disabled} other {AI translation disabled}}',\n              },\n              { enabled: isAISettingEnabled }\n            )}\n          </Typography>\n          <Typography variant=\"pi\" paddingTop={1} paddingBottom={3}>\n            {formatMessage({\n              id: getTranslation('CMEditViewAITranslation.status-description'),\n              defaultMessage:\n                'Our AI translates content in all locales each time you save a modification in the default locale.',\n            })}\n          </Typography>\n          <Link\n            fontSize=\"inherit\"\n            tag={NavLink}\n            to=\"/settings/internationalization\"\n            style={{ alignSelf: 'flex-end' }}\n          >\n            <Typography variant=\"pi\" textAlign=\"right\">\n              {formatMessage(\n                {\n                  id: getTranslation('CMEditViewAITranslation.settings-link'),\n                  defaultMessage:\n                    '{enabled, select, true {Disable it in settings} false {Enable it in settings} other {Enable it in settings}}',\n                },\n                { enabled: isAISettingEnabled }\n              )}\n            </Typography>\n          </Link>\n        </Flex>\n      ),\n    },\n  };\n};\n\n/* -------------------------------------------------------------------------------------------------\n * FillFromAnotherLocaleAction\n * -----------------------------------------------------------------------------------------------*/\n\nconst FillFromAnotherLocaleAction = ({\n  documentId,\n  meta,\n  model,\n  collectionType,\n}: HeaderActionProps) => {\n  const { formatMessage } = useIntl();\n  const [{ query }] = useQueryParams<I18nBaseQuery>();\n  const { hasI18n } = useI18n();\n  const currentDesiredLocale = query.plugins?.i18n?.locale;\n  const [localeSelected, setLocaleSelected] = React.useState<string | null>(null);\n  const setValues = useForm('FillFromAnotherLocale', (state) => state.setValues);\n\n  const { getDocument } = useDocumentActions();\n  const { schema, components } = useDocument({\n    model,\n    documentId,\n    collectionType,\n    params: { locale: currentDesiredLocale },\n  });\n  const { data: locales = [] } = useGetLocalesQuery();\n\n  const isAIAvailable = useAIAvailability();\n  const { data: settings } = useGetSettingsQuery();\n  const isAISettingEnabled = settings?.data?.aiLocalizations;\n\n  const availableLocales = Array.isArray(locales)\n    ? locales.filter((locale) => meta?.availableLocales.some((l) => l.locale === locale.code))\n    : [];\n\n  const fillFromLocale = (onClose: () => void) => async () => {\n    const response = await getDocument({\n      collectionType,\n      model,\n      documentId,\n      params: { locale: localeSelected },\n    });\n    if (!response || !schema) {\n      return;\n    }\n\n    const { data } = response;\n\n    const cleanedData = cleanData(data, schema, components);\n\n    setValues(cleanedData);\n\n    onClose();\n  };\n\n  if (!hasI18n) {\n    return null;\n  }\n\n  // Do not display this action when AI is available and AI translations are enabled\n  if (isAIAvailable && isAISettingEnabled) {\n    return null;\n  }\n\n  return {\n    type: 'icon',\n    icon: <Earth />,\n    disabled: availableLocales.length === 0,\n    label: formatMessage({\n      id: getTranslation('CMEditViewCopyLocale.copy-text'),\n      defaultMessage: 'Fill in from another locale',\n    }),\n    dialog: {\n      type: 'dialog',\n      title: formatMessage({\n        id: getTranslation('CMEditViewCopyLocale.dialog.title'),\n        defaultMessage: 'Confirmation',\n      }),\n      content: ({ onClose }: { onClose: () => void }) => (\n        <>\n          <Dialog.Body>\n            <Flex direction=\"column\" gap={3}>\n              <WarningCircle width=\"24px\" height=\"24px\" fill=\"danger600\" />\n              <Typography textAlign=\"center\">\n                {formatMessage({\n                  id: getTranslation('CMEditViewCopyLocale.dialog.body'),\n                  defaultMessage:\n                    'Your current content will be erased and filled by the content of the selected locale:',\n                })}\n              </Typography>\n              <Field.Root width=\"100%\">\n                <Field.Label>\n                  {formatMessage({\n                    id: getTranslation('CMEditViewCopyLocale.dialog.field.label'),\n                    defaultMessage: 'Locale',\n                  })}\n                </Field.Label>\n                <SingleSelect\n                  value={localeSelected}\n                  placeholder={formatMessage({\n                    id: getTranslation('CMEditViewCopyLocale.dialog.field.placeholder'),\n                    defaultMessage: 'Select one locale...',\n                  })}\n                  // @ts-expect-error â€“ the DS will handle numbers, but we're not allowing the API.\n                  onChange={(value) => setLocaleSelected(value)}\n                >\n                  {availableLocales.map((locale) => (\n                    <SingleSelectOption key={locale.code} value={locale.code}>\n                      {locale.name}\n                    </SingleSelectOption>\n                  ))}\n                </SingleSelect>\n              </Field.Root>\n            </Flex>\n          </Dialog.Body>\n          <Dialog.Footer>\n            <Flex gap={2} width=\"100%\">\n              <Button flex=\"auto\" variant=\"tertiary\" onClick={onClose}>\n                {formatMessage({\n                  id: getTranslation('CMEditViewCopyLocale.cancel-text'),\n                  defaultMessage: 'No, cancel',\n                })}\n              </Button>\n              <Button flex=\"auto\" variant=\"success\" onClick={fillFromLocale(onClose)}>\n                {formatMessage({\n                  id: getTranslation('CMEditViewCopyLocale.submit-text'),\n                  defaultMessage: 'Yes, fill in',\n                })}\n              </Button>\n            </Flex>\n          </Dialog.Footer>\n        </>\n      ),\n    },\n  };\n};\n\n/* -------------------------------------------------------------------------------------------------\n * DeleteLocaleAction\n * -----------------------------------------------------------------------------------------------*/\n\nconst DeleteLocaleAction: DocumentActionComponent = ({\n  document,\n  documentId,\n  model,\n  collectionType,\n}) => {\n  const { formatMessage } = useIntl();\n  const navigate = useNavigate();\n  const { toggleNotification } = useNotification();\n  const { delete: deleteAction, isLoading } = useDocumentActions();\n  const { hasI18n, canDelete } = useI18n();\n\n  // Get the current locale object, using the URL instead of document so it works while creating\n  const [{ query }] = useQueryParams<I18nBaseQuery>();\n  const { data: locales = [] } = useGetLocalesQuery();\n  const currentDesiredLocale = query.plugins?.i18n?.locale;\n  const locale = !('error' in locales) && locales.find((loc) => loc.code === currentDesiredLocale);\n\n  if (!hasI18n) {\n    return null;\n  }\n\n  return {\n    disabled:\n      (document?.locale && !canDelete.includes(document.locale)) || !document || !document.id,\n    position: ['header', 'table-row'],\n    label: formatMessage(\n      {\n        id: getTranslation('actions.delete.label'),\n        defaultMessage: 'Delete entry ({locale})',\n      },\n      { locale: locale && locale.name }\n    ),\n    icon: <StyledTrash />,\n    variant: 'danger',\n    dialog: {\n      type: 'dialog',\n      title: formatMessage({\n        id: getTranslation('actions.delete.dialog.title'),\n        defaultMessage: 'Confirmation',\n      }),\n      content: (\n        <Flex direction=\"column\" gap={2}>\n          <WarningCircle width=\"24px\" height=\"24px\" fill=\"danger600\" />\n          <Typography tag=\"p\" variant=\"omega\" textAlign=\"center\">\n            {formatMessage({\n              id: getTranslation('actions.delete.dialog.body'),\n              defaultMessage: 'Are you sure?',\n            })}\n          </Typography>\n        </Flex>\n      ),\n      loading: isLoading,\n      onConfirm: async () => {\n        const unableToDelete =\n          // We are unable to delete a collection type without a document ID\n          // & unable to delete generally if there is no document locale\n          (collectionType !== 'single-types' && !documentId) || !document?.locale;\n\n        if (unableToDelete) {\n          console.error(\n            \"You're trying to delete a document without an id or locale, this is likely a bug with Strapi. Please open an issue.\"\n          );\n\n          toggleNotification({\n            message: formatMessage({\n              id: getTranslation('actions.delete.error'),\n              defaultMessage: 'An error occurred while trying to delete the document locale.',\n            }),\n            type: 'danger',\n          });\n\n          return;\n        }\n\n        const res = await deleteAction({\n          documentId,\n          model,\n          collectionType,\n          params: { locale: document.locale },\n        });\n\n        if (!('error' in res)) {\n          navigate({ pathname: `../${collectionType}/${model}` }, { replace: true });\n        }\n      },\n    },\n  };\n};\n\nexport type LocaleStatus = {\n  locale: string;\n  status: Modules.Documents.Params.PublicationStatus.Kind | 'modified';\n};\n\ninterface ExtendedDocumentActionProps extends DocumentActionProps {\n  action?: 'bulk-publish' | 'bulk-unpublish';\n}\n\n/* -------------------------------------------------------------------------------------------------\n * BulkLocaleAction\n *\n * This component is used to handle bulk publish and unpublish actions on locales.\n * -----------------------------------------------------------------------------------------------*/\n\nconst BulkLocaleAction: DocumentActionComponent = ({\n  document,\n  documentId,\n  model,\n  collectionType,\n  action,\n  meta,\n}: ExtendedDocumentActionProps) => {\n  const locale = document?.locale ?? null;\n  const [{ query }] = useQueryParams<{ status: 'draft' | 'published' }>();\n\n  const params = React.useMemo(() => buildValidParams(query), [query]);\n  const isOnPublishedTab = query.status === 'published';\n\n  const { formatMessage } = useIntl();\n  const { hasI18n, canPublish } = useI18n();\n  const { toggleNotification } = useNotification();\n  const { _unstableFormatAPIError: formatAPIError } = useAPIErrorHandler();\n\n  const [selectedRows, setSelectedRows] = React.useState<any[]>([]);\n  const [isDraftRelationConfirmationOpen, setIsDraftRelationConfirmationOpen] =\n    React.useState<boolean>(false);\n\n  const { publishMany: publishManyAction, unpublishMany: unpublishManyAction } =\n    useDocumentActions();\n\n  const { schema, validate } = useDocument(\n    {\n      model,\n      collectionType,\n      documentId,\n      params: {\n        locale,\n      },\n    },\n    {\n      // No need to fetch the document, the data is already available in the `document` prop\n      skip: true,\n    }\n  );\n\n  const { data: localesMetadata = [] } = useGetLocalesQuery(hasI18n ? undefined : skipToken);\n\n  const headers = [\n    {\n      label: formatMessage({\n        id: 'global.name',\n        defaultMessage: 'Name',\n      }),\n      name: 'name',\n    },\n    {\n      label: formatMessage({\n        id: getTranslation('CMEditViewBulkLocale.status'),\n        defaultMessage: 'Status',\n      }),\n      name: 'status',\n    },\n    {\n      label: formatMessage({\n        id: getTranslation('CMEditViewBulkLocale.publication-status'),\n        defaultMessage: 'Publication Status',\n      }),\n      name: 'publication-status',\n    },\n  ];\n\n  // Extract the rows for the bulk locale publish modal and any validation\n  // errors per locale\n  const [rows, validationErrors] = React.useMemo(() => {\n    if (!document) {\n      return [[], {}];\n    }\n\n    const metaLocalizations = (meta?.availableLocales ?? []).map((locale) => ({\n      locale: locale.locale,\n      status: (locale.status ?? 'draft') as LocaleStatus['status'],\n    }));\n\n    const documentLocalizations = (\n      (document.localizations ?? []) as Array<{\n        locale?: string | null;\n        status?: Modules.Documents.Params.PublicationStatus.Kind | 'modified' | null;\n      }>\n    ).map((doc) => ({\n      locale: doc.locale ?? undefined,\n      status: (doc.status ?? 'draft') as LocaleStatus['status'],\n    }));\n\n    const localesMap = new Map<string, LocaleStatus>();\n\n    metaLocalizations.forEach(({ locale, status }) => {\n      if (locale) {\n        localesMap.set(locale, { locale, status });\n      }\n    });\n\n    documentLocalizations.forEach(({ locale, status }) => {\n      if (locale) {\n        localesMap.set(locale, { locale, status });\n      }\n    });\n\n    // Build the rows for the bulk locale publish modal by combining the current\n    // document with all the available locales from the document meta\n    const locales: LocaleStatus[] = [];\n\n    if (document?.locale) {\n      locales.push({\n        locale: document.locale,\n        status: (document.status ?? 'draft') as LocaleStatus['status'],\n      });\n    }\n\n    locales.push(\n      ...Array.from(localesMap.entries())\n        .filter(([locale]) => locale !== document?.locale)\n        .map(([, value]) => value)\n    );\n\n    if (locales.length === 0 && document?.locale) {\n      locales.push({\n        locale: document.locale,\n        status: (document.status ?? 'draft') as LocaleStatus['status'],\n      });\n    }\n\n    // Build the validation errors for each locale.\n    const allDocuments = [document, ...(document.localizations ?? [])];\n    const errors = allDocuments.reduce<FormErrors>((errs, document) => {\n      if (!document) {\n        return errs;\n      }\n\n      // Validate each locale entry via the useDocument validate function and store any errors in a dictionary\n      const validation = validate(document as Modules.Documents.AnyDocument);\n      if (validation !== null) {\n        errs[document.locale] = validation;\n      }\n      return errs;\n    }, {});\n\n    return [locales, errors];\n  }, [document, meta?.availableLocales, validate]);\n\n  const isBulkPublish = action === 'bulk-publish';\n  const localesForAction = selectedRows.reduce((acc: string[], selectedRow: LocaleStatus) => {\n    const isValidLocale =\n      // Validation errors are irrelevant if we are trying to unpublish\n      !isBulkPublish || !Object.keys(validationErrors).includes(selectedRow.locale);\n\n    const shouldAddLocale = isBulkPublish\n      ? selectedRow.status !== 'published' && isValidLocale\n      : selectedRow.status !== 'draft' && isValidLocale;\n\n    if (shouldAddLocale) {\n      acc.push(selectedRow.locale);\n    }\n\n    return acc;\n  }, []);\n\n  // TODO skipping this for now as there is a bug with the draft relation count that will be worked on separately\n  // see https://www.notion.so/strapi/Count-draft-relations-56901b492efb45ab90d42fe975b32bd8?pvs=4\n  const enableDraftRelationsCount = false;\n  const {\n    data: draftRelationsCount = 0,\n    isLoading: isDraftRelationsLoading,\n    error: isDraftRelationsError,\n  } = useGetManyDraftRelationCountQuery(\n    {\n      model,\n      documentIds: [documentId!],\n      locale: localesForAction,\n    },\n    {\n      skip: !enableDraftRelationsCount || !documentId || localesForAction.length === 0,\n    }\n  );\n\n  React.useEffect(() => {\n    if (isDraftRelationsError) {\n      toggleNotification({\n        type: 'danger',\n        message: formatAPIError(isDraftRelationsError),\n      });\n    }\n  }, [isDraftRelationsError, toggleNotification, formatAPIError]);\n\n  if (!schema?.options?.draftAndPublish) {\n    return null;\n  }\n\n  if (!hasI18n) {\n    return null;\n  }\n\n  if (!documentId) {\n    return null;\n  }\n\n  // This document action can be enabled given that draft and publish and i18n are\n  // enabled and we can publish the current locale.\n\n  const publish = async () => {\n    await publishManyAction({\n      model,\n      documentIds: [documentId],\n      params: {\n        ...params,\n        locale: localesForAction,\n      },\n    });\n\n    setSelectedRows([]);\n  };\n\n  const unpublish = async () => {\n    await unpublishManyAction({\n      model,\n      documentIds: [documentId],\n      params: {\n        ...params,\n        locale: localesForAction,\n      },\n    });\n\n    setSelectedRows([]);\n  };\n\n  const handleAction = async () => {\n    if (draftRelationsCount > 0) {\n      setIsDraftRelationConfirmationOpen(true);\n    } else if (isBulkPublish) {\n      await publish();\n    } else {\n      await unpublish();\n    }\n  };\n\n  if (isDraftRelationConfirmationOpen) {\n    return {\n      label: formatMessage({\n        id: 'app.components.ConfirmDialog.title',\n        defaultMessage: 'Confirmation',\n      }),\n      variant: 'danger',\n      dialog: {\n        onCancel: () => {\n          setIsDraftRelationConfirmationOpen(false);\n        },\n        onConfirm: async () => {\n          await publish();\n\n          setIsDraftRelationConfirmationOpen(false);\n        },\n        type: 'dialog',\n        title: formatMessage({\n          id: getTranslation('actions.publish.dialog.title'),\n          defaultMessage: 'Confirmation',\n        }),\n        content: (\n          <Flex direction=\"column\" alignItems=\"center\" gap={2}>\n            <WarningCircle width=\"2.4rem\" height=\"2.4rem\" fill=\"danger600\" />\n            <Typography textAlign=\"center\">\n              {formatMessage({\n                id: getTranslation('CMEditViewBulkLocale.draft-relation-warning'),\n                defaultMessage:\n                  'Some locales are related to draft entries. Publishing them could leave broken links in your app.',\n              })}\n            </Typography>\n            <Typography textAlign=\"center\">\n              {formatMessage({\n                id: getTranslation('CMEditViewBulkLocale.continue-confirmation'),\n                defaultMessage: 'Are you sure you want to continue?',\n              })}\n            </Typography>\n          </Flex>\n        ),\n      },\n    };\n  }\n\n  const hasPermission = selectedRows\n    .map(({ locale }) => locale)\n    .every((locale) => canPublish.includes(locale));\n\n  return {\n    label: formatMessage({\n      id: getTranslation(`CMEditViewBulkLocale.${isBulkPublish ? 'publish' : 'unpublish'}-title`),\n      defaultMessage: `${isBulkPublish ? 'Publish' : 'Unpublish'} Multiple Locales`,\n    }),\n    variant: isBulkPublish ? 'secondary' : 'danger',\n    icon: isBulkPublish ? <ListPlus /> : <Cross />,\n    disabled: isOnPublishedTab || canPublish.length === 0,\n    position: ['panel'],\n    dialog: {\n      type: 'modal',\n      title: formatMessage({\n        id: getTranslation(`CMEditViewBulkLocale.${isBulkPublish ? 'publish' : 'unpublish'}-title`),\n        defaultMessage: `${isBulkPublish ? 'Publish' : 'Unpublish'} Multiple Locales`,\n      }),\n      content: () => {\n        return (\n          <Table.Root\n            headers={headers}\n            rows={rows.map((row) => ({\n              ...row,\n              id: row.locale,\n            }))}\n            selectedRows={selectedRows}\n            onSelectedRowsChange={(tableSelectedRows) => setSelectedRows(tableSelectedRows)}\n          >\n            <BulkLocaleActionModal\n              validationErrors={validationErrors}\n              headers={headers}\n              rows={rows}\n              localesMetadata={localesMetadata as Locale[]}\n              action={action ?? 'bulk-publish'}\n            />\n          </Table.Root>\n        );\n      },\n      footer: () => (\n        <Modal.Footer justifyContent=\"flex-end\">\n          <Button\n            loading={isDraftRelationsLoading}\n            disabled={!hasPermission || localesForAction.length === 0}\n            variant=\"default\"\n            onClick={handleAction}\n          >\n            {formatMessage({\n              id: isBulkPublish ? 'app.utils.publish' : 'app.utils.unpublish',\n              defaultMessage: isBulkPublish ? 'Publish' : 'Unpublish',\n            })}\n          </Button>\n        </Modal.Footer>\n      ),\n    },\n  };\n};\n\n/* -------------------------------------------------------------------------------------------------\n * BulkLocalePublishAction\n * -----------------------------------------------------------------------------------------------*/\nconst BulkLocalePublishAction: DocumentActionComponent = (props: ExtendedDocumentActionProps) => {\n  return BulkLocaleAction({ action: 'bulk-publish', ...props });\n};\n\n/* -------------------------------------------------------------------------------------------------\n * BulkLocaleUnpublishAction\n * -----------------------------------------------------------------------------------------------*/\nconst BulkLocaleUnpublishAction: DocumentActionComponent = (props: ExtendedDocumentActionProps) => {\n  return BulkLocaleAction({ action: 'bulk-unpublish', ...props });\n};\n\n/**\n * Because the icon system is completely broken, we have to do\n * this to remove the fill from the cog.\n */\nconst StyledTrash = styled(Trash)`\n  path {\n    fill: currentColor;\n  }\n`;\n\nexport {\n  BulkLocalePublishAction,\n  BulkLocaleUnpublishAction,\n  DeleteLocaleAction,\n  LocalePickerAction,\n  FillFromAnotherLocaleAction,\n  AITranslationStatusAction,\n};\n"],"names":["statusVariants","draft","published","modified","LocaleOption","isDraftAndPublishEnabled","locale","status","entryExists","formatMessage","useIntl","id","getTranslation","defaultMessage","bold","_jsx","b","name","_jsxs","Flex","width","gap","justifyContent","Typography","Status","display","paddingLeft","paddingRight","paddingTop","paddingBottom","size","variant","tag","fontWeight","capitalize","LocaleOptionStartIcon","entryWithLocaleExists","translationStatus","index","isAiAvailable","useAIAvailability","Plus","WarningCircle","fill","LocalePickerAction","document","meta","model","collectionType","documentId","query","setQuery","useQueryParams","hasI18n","canCreate","canRead","useI18n","data","locales","useGetLocalesQuery","currentDesiredLocale","plugins","i18n","schema","useDocument","params","jobData","useGetAILocalizationJobsByDocumentQuery","settings","useGetSettingsQuery","setValues","useForm","state","handleSelect","React","useCallback","value","nonTranslatedFields","useMemo","attributes","Object","keys","filter","field","attribute","pluginOptions","localized","sourceLocaleData","Array","isArray","availableLocales","defaultLocale","find","isDefault","existingLocales","map","loc","sourceLocaleCode","includes","code","sourceLocaleDoc","useEffect","length","dataToSet","reduce","acc","doesLocaleExist","currentLocale","undefined","documentLocalizations","localizations","allLocalizations","allCurrentLocales","getDocumentStatus","displayedLocales","localesSortingDefaultFirst","sort","a","label","options","some","doc","currentLocaleDoc","permissionsToCheck","aiLocalizations","_render","Fragment","SingleSelectOption","disabled","startIcon","draftAndPublish","Box","customizeContent","onSelect","docStatus","statuses","availableStatus","publishedAt","AITranslationStatusIcon","styled","theme","spaces","$isAISettingEnabled","colors","neutral150","neutral300","SpinningLoader","Loader","AITranslationStatusAction","isAIAvailable","isAISettingEnabled","useAILocalizationJobsPolling","statusVariant","_status","message","height","aria-label","Boolean","Sparkle","tooltip","direction","padding","alignItems","enabled","Link","fontSize","NavLink","to","style","alignSelf","textAlign","FillFromAnotherLocaleAction","localeSelected","setLocaleSelected","useState","getDocument","useDocumentActions","components","l","fillFromLocale","onClose","response","cleanedData","cleanData","type","icon","Earth","dialog","title","content","_Fragment","Dialog","Body","Field","Root","Label","SingleSelect","placeholder","onChange","Footer","Button","flex","onClick","DeleteLocaleAction","navigate","useNavigate","toggleNotification","useNotification","delete","deleteAction","isLoading","canDelete","position","StyledTrash","loading","onConfirm","unableToDelete","console","error","res","pathname","replace","BulkLocaleAction","action","buildValidParams","isOnPublishedTab","canPublish","_unstableFormatAPIError","formatAPIError","useAPIErrorHandler","selectedRows","setSelectedRows","isDraftRelationConfirmationOpen","setIsDraftRelationConfirmationOpen","publishMany","publishManyAction","unpublishMany","unpublishManyAction","validate","skip","localesMetadata","skipToken","headers","rows","validationErrors","metaLocalizations","localesMap","Map","forEach","set","push","from","entries","allDocuments","errors","errs","validation","isBulkPublish","localesForAction","selectedRow","isValidLocale","shouldAddLocale","enableDraftRelationsCount","draftRelationsCount","isDraftRelationsLoading","isDraftRelationsError","useGetManyDraftRelationCountQuery","documentIds","publish","unpublish","handleAction","onCancel","hasPermission","every","ListPlus","Cross","Table","row","onSelectedRowsChange","tableSelectedRows","BulkLocaleActionModal","footer","Modal","BulkLocalePublishAction","props","BulkLocaleUnpublishAction","Trash"],"mappings":"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"}