{"version":3,"file":"content-type.mjs","sources":["../../src/plops/content-type.ts"],"sourcesContent":["import { join } from 'path';\nimport type { NodePlopAPI, ActionType } from 'plop';\nimport slugify from '@sindresorhus/slugify';\nimport fs from 'fs-extra';\nimport { strings } from '@strapi/utils';\nimport tsUtils from '@strapi/typescript-utils';\n\nimport getDestinationPrompts from './prompts/get-destination-prompts';\nimport getFilePath from './utils/get-file-path';\nimport ctNamesPrompts from './prompts/ct-names-prompts';\nimport kindPrompts from './prompts/kind-prompts';\nimport getAttributesPrompts from './prompts/get-attributes-prompts';\nimport bootstrapApiPrompts from './prompts/bootstrap-api-prompts';\nimport { appendToFile } from './utils/extend-plugin-index-files';\n\nexport default (plop: NodePlopAPI) => {\n  // Model generator\n  plop.setGenerator('content-type', {\n    description: 'Generate a content type for an API',\n    async prompts(inquirer) {\n      const config = await inquirer.prompt([...ctNamesPrompts, ...kindPrompts]);\n      const attributes = await getAttributesPrompts(inquirer);\n\n      const api = await inquirer.prompt([\n        ...getDestinationPrompts('model', plop.getDestBasePath()),\n        {\n          when: (answers) => answers.destination === 'new',\n          type: 'input',\n          name: 'id',\n          default: config.singularName,\n          message: 'Name of the new API?',\n          async validate(input) {\n            if (!strings.isKebabCase(input)) {\n              return 'Value must be in kebab-case';\n            }\n\n            const apiPath = join(plop.getDestBasePath(), 'api');\n            const exists = await fs.pathExists(apiPath);\n\n            if (!exists) {\n              return true;\n            }\n\n            const apiDir = await fs.readdir(apiPath, { withFileTypes: true });\n            const apiDirContent = apiDir.filter((fd) => fd.isDirectory());\n\n            if (apiDirContent.findIndex((dir) => dir.name === input) !== -1) {\n              throw new Error('This name is already taken.');\n            }\n\n            return true;\n          },\n        },\n        ...bootstrapApiPrompts,\n      ]);\n\n      return {\n        ...config,\n        ...api,\n        attributes,\n      };\n    },\n    actions(answers) {\n      if (!answers) {\n        return [];\n      }\n\n      const attributes = answers.attributes.reduce((object: any, answer: any) => {\n        const val: any = { type: answer.attributeType };\n\n        if (answer.attributeType === 'enumeration') {\n          val.enum = answer.enum.split(',').map((item: string) => item.trim());\n        }\n\n        if (answer.attributeType === 'media') {\n          val.allowedTypes = ['images', 'files', 'videos', 'audios'];\n          val.multiple = answer.multiple;\n        }\n\n        return Object.assign(object, { [answer.attributeName]: val }, {});\n      }, {});\n\n      const filePath = getFilePath(answers.destination);\n      const currentDir = process.cwd();\n      let language = tsUtils.isUsingTypeScriptSync(currentDir) ? 'ts' : 'js';\n\n      if (answers.plugin) {\n        // The tsconfig in plugins is located just outside the server src, not in the root of the plugin.\n        const pluginServerDir = join(\n          currentDir,\n          'src',\n          filePath.replace('{{ plugin }}', answers.plugin),\n          '../'\n        );\n        language = tsUtils.isUsingTypeScriptSync(pluginServerDir) ? 'ts' : 'js';\n      }\n\n      const baseActions: Array<ActionType> = [\n        {\n          type: 'add',\n          path: `${filePath}/content-types/{{ singularName }}/schema.json`,\n          templateFile: `templates/${language}/content-type.schema.json.hbs`,\n          data: {\n            collectionName: slugify(answers.pluralName, { separator: '_' }),\n          },\n        },\n      ];\n\n      if (Object.entries(attributes).length > 0) {\n        baseActions.push({\n          type: 'modify',\n          path: `${filePath}/content-types/{{ singularName }}/schema.json`,\n          transform(template: string) {\n            const parsedTemplate = JSON.parse(template);\n            parsedTemplate.attributes = attributes;\n            return JSON.stringify(parsedTemplate, null, 2);\n          },\n        });\n      }\n\n      if (answers.plugin) {\n        const indexPath = join(\n          plop.getDestBasePath(),\n          `${filePath}/content-types/index.${language}`\n        );\n        const exists = fs.existsSync(indexPath);\n\n        if (!exists) {\n          // Create index file if it doesn't exist\n          baseActions.push({\n            type: 'add',\n            path: `${filePath}/content-types/index.${language}`,\n            templateFile: `templates/${language}/plugin/plugin.index.${language}.hbs`,\n            skipIfExists: true,\n          });\n        }\n\n        // Append the new content type to the index.ts file\n        baseActions.push({\n          type: 'modify',\n          path: `${filePath}/content-types/index.${language}`,\n          transform(template: string) {\n            return appendToFile(template, {\n              type: 'content-type',\n              singularName: answers.singularName,\n            });\n          },\n        });\n      }\n\n      if (answers.bootstrapApi) {\n        const { singularName } = answers;\n\n        let uid;\n        if (answers.destination === 'new') {\n          uid = `api::${answers.id}.${singularName}`;\n        } else if (answers.api) {\n          uid = `api::${answers.api}.${singularName}`;\n        } else if (answers.plugin) {\n          uid = `plugin::${answers.plugin}.${singularName}`;\n        }\n\n        baseActions.push(\n          {\n            type: 'add',\n            path: `${filePath}/controllers/{{ singularName }}.${language}`,\n            templateFile: `templates/${language}/core-controller.${language}.hbs`,\n            data: { uid },\n          },\n          {\n            type: 'add',\n            path: `${filePath}/services/{{ singularName }}.${language}`,\n            templateFile: `templates/${language}/core-service.${language}.hbs`,\n            data: { uid },\n          },\n          {\n            type: 'add',\n            path: `${filePath}/routes/${answers.plugin ? 'content-api/' : ''}{{ singularName }}.${language}`,\n            templateFile: `templates/${language}/core-router.${language}.hbs`,\n            data: { uid },\n          }\n        );\n\n        if (answers.plugin) {\n          const indexFiles = ['controllers', 'services', 'routes'];\n\n          indexFiles.forEach((type) => {\n            const indexPath = join(plop.getDestBasePath(), `${filePath}/${type}/index.${language}`);\n            const exists = fs.existsSync(indexPath);\n\n            if (!exists && type !== 'routes') {\n              baseActions.push({\n                type: 'add',\n                path: `${filePath}/${type}/index.${language}`,\n                templateFile: `templates/${language}/plugin/plugin.index.${language}.hbs`,\n                skipIfExists: true,\n              });\n            }\n\n            if (type === 'routes') {\n              const indexPath = join(\n                plop.getDestBasePath(),\n                `${filePath}/${type}/index.${language}`\n              );\n              const exists = fs.existsSync(indexPath);\n\n              if (!exists) {\n                baseActions.push({\n                  type: 'add',\n                  path: `${filePath}/${type}/index.${language}`,\n                  templateFile: `templates/${language}/plugin/plugin.routes.index.${language}.hbs`,\n                  skipIfExists: true,\n                });\n              }\n\n              const routeIndexFiles = ['content-api', 'admin'];\n\n              routeIndexFiles.forEach((routeType) => {\n                const routeTypeIndexPath = join(\n                  plop.getDestBasePath(),\n                  `${filePath}/${type}/${routeType}/index.${language}`\n                );\n                const routeTypeExists = fs.existsSync(routeTypeIndexPath);\n\n                if (!routeTypeExists) {\n                  baseActions.push({\n                    type: 'add',\n                    path: `${filePath}/${type}/${routeType}/index.${language}`,\n                    templateFile: `templates/${language}/plugin/plugin.routes.type.index.${language}.hbs`,\n                    data: { type: routeType },\n                    skipIfExists: true,\n                  });\n                }\n              });\n            }\n\n            baseActions.push({\n              type: 'modify',\n              path: `${filePath}/${type}/${type === 'routes' ? 'content-api/' : ''}index.${language}`,\n              transform(template: string) {\n                if (type === 'routes') {\n                  return appendToFile(template, {\n                    type: 'routes',\n                    singularName: answers.singularName,\n                  });\n                }\n\n                return appendToFile(template, {\n                  type: 'index',\n                  singularName: answers.singularName,\n                });\n              },\n            });\n          });\n        }\n      }\n\n      return baseActions;\n    },\n  });\n};\n"],"names":["plop","setGenerator","description","prompts","inquirer","config","prompt","ctNamesPrompts","kindPrompts","attributes","getAttributesPrompts","api","getDestinationPrompts","getDestBasePath","when","answers","destination","type","name","default","singularName","message","validate","input","strings","isKebabCase","apiPath","join","exists","fs","pathExists","apiDir","readdir","withFileTypes","apiDirContent","filter","fd","isDirectory","findIndex","dir","Error","bootstrapApiPrompts","actions","reduce","object","answer","val","attributeType","enum","split","map","item","trim","allowedTypes","multiple","Object","assign","attributeName","filePath","getFilePath","currentDir","process","cwd","language","tsUtils","isUsingTypeScriptSync","plugin","pluginServerDir","replace","baseActions","path","templateFile","data","collectionName","slugify","pluralName","separator","entries","length","push","transform","template","parsedTemplate","JSON","parse","stringify","indexPath","existsSync","skipIfExists","appendToFile","bootstrapApi","uid","id","indexFiles","forEach","routeIndexFiles","routeType","routeTypeIndexPath","routeTypeExists"],"mappings":"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"}