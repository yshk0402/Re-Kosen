{"version":3,"file":"Notifications.mjs","sources":["../../../../../admin/src/features/Notifications.tsx"],"sourcesContent":["import * as React from 'react';\n\nimport { Alert, AlertVariant, Link, Box } from '@strapi/design-system';\nimport { useIntl } from 'react-intl';\nimport { Toaster, toast } from 'sonner';\n\ninterface NotificationLink {\n  label: string;\n  target?: string;\n  url: string;\n}\n\ninterface NotificationConfig {\n  blockTransition?: boolean;\n  link?: NotificationLink;\n  message?: string;\n  onClose?: () => void;\n  timeout?: number;\n  title?: string;\n  type?: 'info' | 'warning' | 'danger' | 'success';\n}\n\n/* -------------------------------------------------------------------------------------------------\n * Context\n * -----------------------------------------------------------------------------------------------*/\n\ninterface NotificationsContextValue {\n  /**\n   * Toggles a notification, wrapped in `useCallback` for a stable identity.\n   */\n  toggleNotification: (config: NotificationConfig) => void;\n}\n\nconst NotificationsContext = React.createContext<NotificationsContextValue>({\n  toggleNotification: () => {},\n});\n\n/* -------------------------------------------------------------------------------------------------\n * Provider\n * -----------------------------------------------------------------------------------------------*/\n\n/**\n * @internal\n * @description exposes the `NotificationsContext` to its children and renders notifications\n */\nconst NotificationsProvider = ({ children }: { children: React.ReactNode }) => {\n  const toggleNotification = React.useCallback(\n    ({ type, message, link, timeout, blockTransition, onClose, title }: NotificationConfig) => {\n      toast.custom(\n        (id) => {\n          return (\n            <Box width=\"50rem\" maxWidth=\"100%\">\n              <Notification\n                type={type}\n                message={message}\n                title={title}\n                link={link}\n                clearNotification={() => {\n                  toast.dismiss(id);\n                  onClose?.();\n                }}\n              />\n            </Box>\n          );\n        },\n        { duration: blockTransition ? Infinity : timeout }\n      );\n    },\n    []\n  );\n\n  const value = React.useMemo(() => ({ toggleNotification }), [toggleNotification]);\n\n  return (\n    <>\n      <Toaster position=\"top-center\" />\n      <NotificationsContext.Provider value={value}>{children}</NotificationsContext.Provider>\n    </>\n  );\n};\n\ninterface NotificationProps extends Omit<NotificationConfig, 'blockTransition' | 'timeout'> {\n  clearNotification: () => void;\n}\n\nconst Notification = ({\n  clearNotification,\n  link,\n  message,\n  onClose,\n  title,\n  type,\n}: NotificationProps) => {\n  const { formatMessage } = useIntl();\n\n  const getVariant = (): AlertVariant => {\n    switch (type) {\n      case 'info':\n        return 'default';\n      case 'danger':\n        return 'danger';\n      case 'warning':\n        return 'warning';\n      default:\n        return 'success';\n    }\n  };\n\n  return (\n    <Alert\n      action={\n        link ? (\n          <Link href={link.url} isExternal>\n            {link.label}\n          </Link>\n        ) : undefined\n      }\n      onClose={() => {\n        onClose?.();\n        clearNotification();\n      }}\n      closeLabel={formatMessage({\n        id: 'global.close',\n        defaultMessage: 'Close',\n      })}\n      title={title}\n      variant={getVariant()}\n    >\n      {message}\n    </Alert>\n  );\n};\n\n/* -------------------------------------------------------------------------------------------------\n * Hook\n * -----------------------------------------------------------------------------------------------*/\n\n/**\n * @preserve\n * @description Returns an object to interact with the notification\n * system. The callbacks are wrapped in `useCallback` for a stable\n * identity.\n *\n * @example\n * ```tsx\n * import { useNotification } from '@strapi/strapi/admin';\n *\n * const MyComponent = () => {\n *  const { toggleNotification } = useNotification();\n *\n *  return <button onClick={() => toggleNotification({ message: 'Hello world!' })}>Click me</button>;\n */\nconst useNotification = () => React.useContext(NotificationsContext);\n\nexport { NotificationsProvider, useNotification };\nexport type { NotificationConfig, NotificationsContextValue };\n"],"names":["NotificationsContext","React","createContext","toggleNotification","NotificationsProvider","children","useCallback","type","message","link","timeout","blockTransition","onClose","title","toast","custom","id","_jsx","Box","width","maxWidth","Notification","clearNotification","dismiss","duration","Infinity","value","useMemo","_jsxs","_Fragment","Toaster","position","Provider","formatMessage","useIntl","getVariant","Alert","action","Link","href","url","isExternal","label","undefined","closeLabel","defaultMessage","variant","useNotification","useContext"],"mappings":"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"}